{% extends "admin/layout_admin.html" %}

{% block sidebar %}
  {% include 'admin/sidebar.html' %}
{% endblock %}

{% block content %}
<!-- ============================================================================ -->
<!--                              KONTEN UTAMA                                    -->
<!-- ============================================================================ -->
<div class="p-6 flex flex-col h-screen">
  
  <!-- Judul Halaman -->
  <h1 class="mt-4 mb-6 text-center text-4xl font-bold text-black">
    Manage Job Vacancies
  </h1>

  <!-- Flash Messages -->
  {% include 'partials/flash.html' %}

  <!-- ========================================================================== -->
  <!--                         CONTAINER DAFTAR LOWONGAN                          -->
  <!-- ========================================================================== -->
  <div class="bg-[#0BDAAA] rounded-3xl p-6 flex-1 overflow-y-auto mt-8">
    
    <!-- Header: Tombol & Selector -->
    <div class="flex justify-between items-center mb-6 gap-4">
      

      <!-- Selector Program (Kanan) -->
      <form 
        method="get" 
        action="{{ url_for('lowongan.read_lowongan') }}" 
        class="flex-1 max-w-md"
      >
        <select 
          name="program_id" 
          onchange="this.form.submit()" 
          class="w-full px-4 py-3 bg-black/10 rounded-xl text-black font-bold focus:outline-none" 
          required
        >
          {% for program in programs %}
          <option 
            value="{{ program[0] }}" 
            {% if program[0]|string == selected_program_id|string %}selected{% endif %} 
            style="background-color: #15f275; font-weight: bold"
          >
            {{ program[1] if program[1] else 'Program ' ~ program[0] }}
          </option>
          {% endfor %}
        </select>
      </form>
      
    </div>
    
    <!-- ====================================================================== -->
    <!--                          DAFTAR LOWONGAN                               -->
    <!-- ====================================================================== -->
    {% if lowongan | length > 0 %}
    
    <div class="space-y-4">
      {% for item in lowongan %}
      <!-- Card Lowongan -->
      <div class="bg-black/10 rounded-2xl p-5 hover:bg-black/20 transition-all">
        
        <div class="flex justify-between items-start">
          
          <!-- Info Lowongan -->
          <div class="flex-1">
            <h3 class="text-black font-bold text-xl mb-2">
              {{ item.judul }}
            </h3>
            
            <div class="space-y-1">
              <p class="text-black/80 font-semibold">
                <span class="inline-block w-32">Status:</span>
                <span class="px-3 py-1 rounded-full text-sm font-bold {% if item.status == 'dibuka' %}bg-green-200 text-green-800{% else %}bg-red-200 text-red-800{% endif %}">
                  {{ 'OPEN' if item.status == 'dibuka' else 'CLOSED' }}
                </span>
              </p>
              <p class="text-black/80 font-semibold">
                <span class="inline-block w-32">Age Range:</span>
                {{ item.min_umur }} - {{ item.max_umur }} years
              </p>
              <p class="text-black/80 font-semibold">
                <span class="inline-block w-32">Min. Education:</span>
                {{ item.min_pendidikan }}
              </p>
              <p class="text-black/80 font-semibold">
                <span class="inline-block w-32">Quota:</span>
                {{ item.kuota_pekerja }}
              </p>
            </div>
          </div>
          
          <!-- Tombol Aksi -->
          <div class="flex gap-2 ml-4">
            <a 
              href="{{ url_for('lowongan.edit_lowongan', lowongan_id=item.id) }}" 
              class="bg-[#15F275] hover:bg-[#C7FB01] text-black font-bold px-6 py-2 rounded-full transition-colors"
            >
              Edit
            </a>
            <form 
              method="POST" 
              action="{{ url_for('lowongan.delete_lowongan', lowongan_id=item.id) }}" 
              style="display:inline;" 
              onsubmit="return confirm('Are you sure you want to delete this job vacancy?')"
            >
              <button 
                type="submit" 
                class="bg-red-500 hover:bg-red-600 text-white font-bold px-6 py-2 rounded-full transition-colors"
              >
                Delete
              </button>
            </form>
          </div>
          
        </div>
        
        <!-- Detail Tambahan (Collapsible) -->
        <details class="mt-4">
          <summary class="cursor-pointer text-black font-bold hover:text-black/70 transition-colors">
            View Full Details
          </summary>
          <div class="mt-3 pt-3 border-t border-black/10 space-y-2">
            <div>
              <p class="text-black font-bold text-sm mb-1">Skills:</p>
              <p class="text-black/80 text-sm">{{ item.keahlian }}</p>
            </div>
            <div>
              <p class="text-black font-bold text-sm mb-1">Experience:</p>
              <p class="text-black/80 text-sm">{{ item.pengalaman }}</p>
            </div>
          </div>
        </details>
        
      </div>
      {% endfor %}
    </div>
    
    {% else %}
    <!-- ====================================================================== -->
    <!--                      STATE: BELUM ADA LOWONGAN                         -->
    <!-- ====================================================================== -->
    <div class="text-center py-12">
      <p class="text-black/60 font-bold text-lg mb-4">
        No job vacancies available for this program yet.
      </p>
      <a 
        href="{{ url_for('lowongan.create_lowongan', program_id=selected_program_id) }}" 
        class="inline-block bg-[#15F275] hover:bg-[#C7FB01] text-black font-bold px-8 py-3 rounded-full transition-colors"
      >
        Create First Vacancy
      </a>
    </div>
    {% endif %}
    
  </div>

</div>

{% endblock %}