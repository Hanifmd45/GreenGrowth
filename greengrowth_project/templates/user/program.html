{% extends "layout.html" %}

{% block title %}{{ program.nama_program }} | GreenGrowth{% endblock %}

{% block body_class %}bg-[#ECFDF5] font-sans{% endblock %}

{% block article %}
<div class="w-full p-6 md:p-10">

  <div class="max-w-7xl mx-auto grid grid-cols-1 md:grid-cols-12 gap-8">

    <!-- ===================== -->
    <!-- PROGRAM -->
    <!-- ===================== -->
    <aside class="md:col-span-5 order-1 md:order-2">

      <div class="bg-[#0BDAAA] rounded-3xl p-6 md:p-8 text-white shadow-xl relative overflow-hidden">

        <!-- Decorative -->
        <div class="absolute -top-10 -right-10 w-40 h-40 bg-[#15F275]/40 rounded-full"></div>

        {% set status_program = program.status_program|default('perencanaan') %}

        <!-- Status Program -->
        <span class="absolute top-4 right-4 text-xs font-bold px-4 py-1 rounded-full
          {% if status_program == 'perencanaan' %}
            bg-yellow-300 text-yellow-900
          {% elif status_program == 'berjalan' %}
            bg-blue-500 text-white
          {% elif status_program == 'selesai' %}
            bg-emerald-400 text-emerald-900
          {% endif %}
        ">
          {{ status_program }}
        </span>

        <!-- Judul Program -->
        <h2 class="text-xl font-semibold mb-2">
          üåø {{ program.nama_program }}
        </h2>

        <!-- Sektor / Tujuan -->
        <p class="text-sm text-emerald-100 mb-5">
          {{ program.sektor_program }}
        </p>

        <div class="space-y-3 text-sm">
          <div>üìç {{ program.lokasi_program }}</div>

          <p class="leading-relaxed text-emerald-100">
            {{ program.deskripsi_program }}
          </p>
        </div>

      </div>
    </aside>

    <!-- ===================== -->
    <!-- LOWONGAN -->
    <!-- ===================== -->
    <section class="md:col-span-7 space-y-6 order-2 md:order-1">

      <!-- Header -->
      <div class="flex flex-col sm:flex-row sm:items-end sm:justify-between gap-3">
        <div>
          <h1 class="text-2xl font-bold text-[#064E3B]">
            Green Growth Opportunities
          </h1>
          <p class="text-sm text-[#0BDAAA]">
            Lowongan berkelanjutan & ramah lingkungan
          </p>
        </div>

        <span class="bg-[#C7FB01] text-[#064E3B] text-xs font-semibold px-4 py-1 rounded-full w-fit">
          {{ lowongan|length }} lowongan tersedia
        </span>
      </div>

      <!-- Card Lowongan -->
      {% for l in lowongan %}
      {% set status_lowongan = l.status_lowongan %}

      <div class="flex gap-4 bg-white rounded-2xl p-5 shadow hover:shadow-xl transition">

        <div class="w-1.5 bg-[#15F275] rounded-full"></div>

        <div class="flex-1">
          <div class="flex justify-between items-start">
            <h3 class="font-semibold text-[#064E3B]">
              {{ l.judul_lowongan }}
            </h3>

            <!-- Status Lowongan -->
            <span class="text-[11px] px-3 py-1 rounded-full font-semibold
              {% if status_lowongan == 'dibuka' %}
                bg-emerald-500 text-white
              {% elif status_lowongan == 'ditutup' %}
                bg-red-500 text-white
              {% endif %}
            ">
              {{ status_lowongan }}
            </span>
          </div>

          <!-- Detail -->
          <ul class="list-disc ml-5 mt-2 space-y-1 text-sm text-gray-600">
            {% if l.lowongan_keahlian %}
              <li>Keahlian: {{ l.lowongan_keahlian }}</li>
            {% endif %}
            {% if l.lowongan_pengalaman %}
              <li>Pengalaman: {{ l.lowongan_pengalaman }}</li>
            {% endif %}
            {% if l.lowongan_min_pendidikan %}
              <li>Pendidikan: {{ l.lowongan_min_pendidikan }}</li>
            {% endif %}
          </ul>

          <div class="flex justify-between items-center mt-4">
            <span class="text-sm text-[#064E3B] font-medium">
              üë• {{ l.kuota_pekerja }} orang
            </span>

            <!-- Tombol -->
            <button
              class="text-sm px-5 py-1.5 rounded-full transition
                {% if status_lowongan == 'dibuka' %}
                  bg-[#15F275] hover:bg-[#0BDAAA] text-white
                {% else %}
                  bg-gray-300 text-gray-500 cursor-not-allowed
                {% endif %}
              "
              {% if status_lowongan != 'dibuka' %}disabled{% endif %}
            >
              accept
            </button>
          </div>
        </div>
      </div>

      {% else %}
      <div class="text-sm text-gray-500 italic">
        Belum ada lowongan untuk program ini.
      </div>
      {% endfor %}

    </section>

  </div>
</div>
{% endblock %}
